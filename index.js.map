{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/img/error-pic.svg","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nconst BASE_URL = \"https://pixabay.com/api/\";\nconst API_KEY = \"52805756-0bb10a10045fa9da16982d34a\";\n\nexport async function getImagesByQuery(query, page) {\n  const params = {\n    key: API_KEY,\n    q: query,\n    image_type: \"photo\",\n    orientation: \"horizontal\",\n    safesearch: true,\n    per_page: 15,\n    page,\n  };\n\n  const response = await axios.get(BASE_URL, { params });\n  return response.data;\n}\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst galleryContainer = document.querySelector(\".gallery\");\nconst loadMoreBtn = document.querySelector(\".load-more\");\nconst loader = document.querySelector(\".loader\");\n\nlet lightbox = new SimpleLightbox(\".gallery a\", {\n  captionsData: \"alt\",\n  captionDelay: 250,\n});\n\nexport function createGallery(images) {\n  const markup = images\n    .map(\n      (img) => `\n      <li class=\"gallery-item\">\n        <a href=\"${img.largeImageURL}\">\n          <img src=\"${img.webformatURL}\" alt=\"${img.tags}\" loading=\"lazy\" />\n        </a>\n        <ul class=\"info\">\n          <li><b>Likes:</b> ${img.likes}</li>\n          <li><b>Views:</b> ${img.views}</li>\n          <li><b>Comments:</b> ${img.comments}</li>\n          <li><b>Downloads:</b> ${img.downloads}</li>\n        </ul>\n      </li>`\n    )\n    .join(\"\");\n\n  galleryContainer.insertAdjacentHTML(\"beforeend\", markup);\n\n  lightbox.refresh();\n}\n\nexport function clearGallery() {\n  galleryContainer.innerHTML = \"\";\n  lightbox.refresh();\n}\n\nexport function showLoader() {\n  loader.classList.remove(\"is-hidden\");\n}\nexport function hideLoader() {\n  loader.classList.add(\"is-hidden\");\n}\n\nexport function showLoadMoreButton() {\n  loadMoreBtn.classList.remove(\"is-hidden\");\n}\nexport function hideLoadMoreButton() {\n  loadMoreBtn.classList.add(\"is-hidden\");\n}\n\nexport const loadMoreButton = loadMoreBtn;\n\nexport const galleryEl = galleryContainer;","export default \"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20fill='none'%3e%3cg%20fill='%23FAFAFB'%20clip-path='url(%23a)'%3e%3cpath%20d='M6.81.219A.75.75%200%200%201%207.34%200h9.32a.75.75%200%200%201%20.53.219l6.591%206.591a.75.75%200%200%201%20.219.53v9.32a.75.75%200%200%201-.219.53l-6.591%206.591a.75.75%200%200%201-.53.219H7.34a.75.75%200%200%201-.53-.219L.219%2017.19A.75.75%200%200%201%200%2016.66V7.34a.75.75%200%200%201%20.219-.53L6.81.219ZM7.65%201.5%201.5%207.65v8.7l6.15%206.15h8.7l6.15-6.15v-8.7L16.35%201.5h-8.7Z'/%3e%3cpath%20d='M6.969%206.969a.75.75%200%200%201%201.062%200L12%2010.939l3.969-3.97a.75.75%200%201%201%201.062%201.062L13.06%2012l3.97%203.969a.752.752%200%200%201-1.062%201.062l-3.97-3.97-3.968%203.97a.753.753%200%200%201-1.225-.244.751.751%200%200%201%20.163-.818L10.939%2012%206.97%208.031a.75.75%200%200%201%200-1.062Z'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='a'%3e%3cpath%20fill='%23fff'%20d='M0%200h24v24H0z'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e\"","import { getImagesByQuery } from \"./js/pixabay-api.js\";\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n  loadMoreButton,\n  galleryEl,\n} from \"./js/render-functions.js\";\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport errorPicSVG from './img/error-pic.svg';\n\nconst form = document.querySelector(\".form\");\nconst input = form.querySelector(\"input[name='search-text']\");\n\nlet currentQuery = \"\";\nlet currentPage = 1;\nconst PER_PAGE = 15;\nlet totalHits = 0;\nlet loadedHits = 0;\n\nconst errorToastOptions = {\n  position: \"topRight\",\n  backgroundColor: '#EF4040',\n  messageColor: '#FFFFFF',\n  iconUrl: errorPicSVG,\n  iconColor: '#FFFFFF',\n  progressBar: true,\n  progressBarColor: '#B51B1B',\n  close: true,\n  timeout: 5000,\n  pauseOnHover: true,\n  width: '432px',\n  height: '88px',\n  padding: '20px',\n  borderRadius: '4px',\n  class: 'custom-error-toast',\n};\n\nform.addEventListener(\"submit\", onSearch);\nloadMoreButton.addEventListener(\"click\", onLoadMore);\n\nasync function onSearch(event) {\n  event.preventDefault();\n\n  const query = input.value.trim();\n\n  if (!query) {\n    iziToast.warning({\n      message: \"Please enter a search term!\",\n      position: \"topRight\",\n    });\n    return;\n  }\n\n  if (query !== currentQuery) {\n    currentQuery = query;\n    currentPage = 1;\n    loadedHits = 0;\n    totalHits = 0;\n  }\n\n  clearGallery();\n  hideLoadMoreButton();\n  showLoader();\n\n  try {\n    const data = await getImagesByQuery(currentQuery, currentPage);\n\n    totalHits = data.totalHits || 0;\n\n    if (!data.hits || data.hits.length === 0) {\n      iziToast.error({\n        message:\n          \"Sorry, there are no images matching your search query. Please try again!\",\n        ...errorToastOptions,\n      });\n      return;\n    }\n\n    createGallery(data.hits);\n\n    loadedHits += data.hits.length;\n\n      if (loadedHits < totalHits) {\n      showLoadMoreButton();\n    } else {\n      hideLoadMoreButton();\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: \"topRight\",\n      });\n    }\n  } catch (error) {\n    iziToast.error({\n      message: \"Something went wrong. Please try again later.\",\n      ...errorToastOptions,\n    });\n  } finally {\n    hideLoader();\n    input.value = \"\";\n  }\n}\n\nasync function onLoadMore() {\n  loadMoreButton.disabled = true;\n  showLoader();\n\n  currentPage += 1;\n\n  try {\n    const data = await getImagesByQuery(currentQuery, currentPage);\n\n    createGallery(data.hits);\n\n    loadedHits += data.hits.length;\n\n    const firstCard = galleryEl.querySelector(\".gallery-item\");\n    if (firstCard) {\n      const { height } = firstCard.getBoundingClientRect();\n      window.scrollBy({\n        top: height * 2,\n        behavior: \"smooth\",\n      });\n    }\n\n    if (loadedHits >= (data.totalHits || totalHits)) {\n      hideLoadMoreButton();\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: \"topRight\",\n      });\n    } else {\n      showLoadMoreButton();\n    }\n  } catch (error) {\n    iziToast.error({\n      message: \"Something went wrong while loading more images.\",\n      ...errorToastOptions,\n    });\n  } finally {\n    hideLoader();\n    loadMoreButton.disabled = false;\n  }\n}\n"],"names":["BASE_URL","API_KEY","getImagesByQuery","query","page","params","axios","galleryContainer","loadMoreBtn","loader","lightbox","SimpleLightbox","createGallery","images","markup","img","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","loadMoreButton","galleryEl","errorPicSVG","form","input","currentQuery","currentPage","totalHits","loadedHits","errorToastOptions","onSearch","onLoadMore","event","iziToast","data","firstCard","height"],"mappings":"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"}